# ‚úÖ –ß–µ–∫–ª–∏—Å—Ç –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ Click –¥–ª—è kvartirabar.uz

## –®–∞–≥ 1: –ü–æ–ª—É—á–∏—Ç–µ –¥–∞–Ω–Ω—ã–µ –æ—Ç Click

1. –ó–∞–π–¥–∏—Ç–µ –≤ –ª–∏—á–Ω—ã–π –∫–∞–±–∏–Ω–µ—Ç Click: https://click.uz/
2. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ —Ä–∞–∑–¥–µ–ª **"API –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è"** –∏–ª–∏ **"–ù–∞—Å—Ç—Ä–æ–π–∫–∏"**
3. –ù–∞–π–¥–∏—Ç–µ –∏ —Å–∫–æ–ø–∏—Ä—É–π—Ç–µ:
   - ‚úÖ **Service ID** (–Ω–∞–ø—Ä–∏–º–µ—Ä: `12345`)
   - ‚úÖ **Secret Key** (–Ω–∞–ø—Ä–∏–º–µ—Ä: `abc123def456`)

## –®–∞–≥ 2: –ù–∞—Å—Ç—Ä–æ–π—Ç–µ callback URLs –≤ Click

–í –ª–∏—á–Ω–æ–º –∫–∞–±–∏–Ω–µ—Ç–µ Click —É–∫–∞–∂–∏—Ç–µ:

```
‚úÖ Prepare URL:  https://kvartirabar.uz/api/auctions/click/prepare/
‚úÖ Complete URL: https://kvartirabar.uz/api/auctions/click/complete/
```

**–í–∞–∂–Ω–æ:** URL –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å —Å `https://` (SSL –æ–±—è–∑–∞—Ç–µ–ª–µ–Ω!)

## –®–∞–≥ 3: –û–±–Ω–æ–≤–∏—Ç–µ config/settings.py

–û—Ç–∫—Ä–æ–π—Ç–µ —Ñ–∞–π–ª `config/settings.py` –∏ –∑–∞–º–µ–Ω–∏—Ç–µ —Å—Ç—Ä–æ–∫–∏ 22-23:

```python
# –ë–´–õ–û:
CLICK_SERVICE_ID = '–≤–∞—à_service_id'
CLICK_SECRET_KEY = '–≤–∞—à_secret_key'

# –î–û–õ–ñ–ù–û –ë–´–¢–¨ (–≤–∞—à–∏ —Ä–µ–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ):
CLICK_SERVICE_ID = '12345'  # ‚Üê –í–∞—à —Ä–µ–∞–ª—å–Ω—ã–π Service ID –æ—Ç Click
CLICK_SECRET_KEY = 'abc123def456'  # ‚Üê –í–∞—à —Ä–µ–∞–ª—å–Ω—ã–π Secret Key –æ—Ç Click
```

## –®–∞–≥ 4: –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —á—Ç–æ —Å–µ—Ä–≤–µ—Ä –¥–æ—Å—Ç—É–ø–µ–Ω

–í—ã–ø–æ–ª–Ω–∏—Ç–µ –∫–æ–º–∞–Ω–¥—ã –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ:

```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ Prepare endpoint
curl -X POST https://kvartirabar.uz/api/auctions/click/prepare/ \
  -H "Content-Type: application/json" \
  -d '{}'

# –ü—Ä–æ–≤–µ—Ä–∫–∞ Complete endpoint
curl -X POST https://kvartirabar.uz/api/auctions/click/complete/ \
  -H "Content-Type: application/json" \
  -d '{}'
```

–î–æ–ª–∂–Ω—ã –≤–µ—Ä–Ω—É—Ç—å—Å—è JSON –æ—Ç–≤–µ—Ç—ã (–∞ –Ω–µ 404 –∏–ª–∏ 500 –æ—à–∏–±–∫–∏).

## –®–∞–≥ 5: –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ Django

```bash
# –ï—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç–µ systemd
sudo systemctl restart your-django-service

# –ò–ª–∏ –µ—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç–µ gunicorn
sudo supervisorctl restart your-app

# –ò–ª–∏ –Ω–∞ PythonAnywhere
# –ù–∞–∂–º–∏—Ç–µ "Reload" –≤ –≤–µ–±-–∫–æ–Ω—Å–æ–ª–∏
```

## –®–∞–≥ 6: –¢–µ—Å—Ç–æ–≤–∞—è –æ–ø–ª–∞—Ç–∞

1. –û—Ç–∫—Ä–æ–π—Ç–µ https://kvartirabar.uz
2. –í–æ–π–¥–∏—Ç–µ –∫–∞–∫ –ø—Ä–æ–¥–∞–≤–µ—Ü
3. –°–æ–∑–¥–∞–π—Ç–µ –Ω–æ–≤–æ–µ –æ–±—ä—è–≤–ª–µ–Ω–∏–µ
4. –°–æ–∑–¥–∞–π—Ç–µ –∞—É–∫—Ü–∏–æ–Ω –¥–ª—è —ç—Ç–æ–≥–æ –æ–±—ä—è–≤–ª–µ–Ω–∏—è
5. –ù–∞–∂–º–∏—Ç–µ **"–ò–Ω–∏—Ü–∏–∏—Ä–æ–≤–∞—Ç—å –æ–ø–ª–∞—Ç—É"**
6. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ **merchant_trans_id** (–Ω–∞–ø—Ä–∏–º–µ—Ä: `AUCTION_A1B2C3D4E5F6G7H8I9J0`)
7. –û—Ç–∫—Ä–æ–π—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ **Click** –Ω–∞ —Ç–µ–ª–µ—Ñ–æ–Ω–µ
8. –ù–∞–π–¥–∏—Ç–µ –≤–∞—à —Å–µ—Ä–≤–∏—Å –∏–ª–∏ –≤–≤–µ–¥–∏—Ç–µ –Ω–æ–º–µ—Ä —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏
9. –û–ø–ª–∞—Ç–∏—Ç–µ **50,000 —Å—É–º**
10. –í–µ—Ä–Ω–∏—Ç–µ—Å—å –Ω–∞ —Å–∞–π—Ç –∏ –æ–±–Ω–æ–≤–∏—Ç–µ —Å—Ç—Ä–∞–Ω–∏—Ü—É
11. –°—Ç–∞—Ç—É—Å –∞—É–∫—Ü–∏–æ–Ω–∞ –¥–æ–ª–∂–µ–Ω –∏–∑–º–µ–Ω–∏—Ç—å—Å—è –Ω–∞ **"–ó–∞–ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω"** –∏–ª–∏ **"–ê–∫—Ç–∏–≤–µ–Ω"**

## –®–∞–≥ 7: –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö

```bash
python manage.py shell

from auctions.models import AuctionPayment, Auction

# –ü—Ä–æ–≤–µ—Ä—è–µ–º –ø–æ—Å–ª–µ–¥–Ω–∏–π –ø–ª–∞—Ç–µ–∂
last_payment = AuctionPayment.objects.last()
print(f"Status: {last_payment.status}")
print(f"Amount: {last_payment.amount}")
print(f"Merchant Trans ID: {last_payment.merchant_trans_id}")

# –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å–≤—è–∑–∞–Ω–Ω—ã–π –∞—É–∫—Ü–∏–æ–Ω
auction = last_payment.auction
print(f"Auction Status: {auction.status}")
print(f"Is Paid: {auction.is_paid}")
```

## –í–æ–∑–º–æ–∂–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã –∏ —Ä–µ—à–µ–Ω–∏—è

### ‚ùå Click –Ω–µ –ø—Ä–∏—Å—ã–ª–∞–µ—Ç callback

**–†–µ—à–µ–Ω–∏–µ:**
1. –£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ URLs –¥–æ—Å—Ç—É–ø–Ω—ã –∏–∑–≤–Ω–µ (curl —Ç–µ—Å—Ç)
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —á—Ç–æ –≤ –ø–∞–Ω–µ–ª–∏ Click —É–∫–∞–∑–∞–Ω—ã –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ URLs —Å `https://`
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ firewall –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ (–ø–æ—Ä—Ç—ã 80 –∏ 443 –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –æ—Ç–∫—Ä—ã—Ç—ã)

### ‚ùå –û—à–∏–±–∫–∞ "Sign check failed"

**–†–µ—à–µ–Ω–∏–µ:**
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —á—Ç–æ `CLICK_SECRET_KEY` –≤ settings.py —Å–æ–≤–ø–∞–¥–∞–µ—Ç —Å –∫–ª—é—á–æ–º –∏–∑ Click –ø–∞–Ω–µ–ª–∏
2. –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ Django –ø–æ—Å–ª–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è settings.py

### ‚ùå –û—à–∏–±–∫–∞ "Transaction does not exist"

**–†–µ—à–µ–Ω–∏–µ:**
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —á—Ç–æ –≤—ã –Ω–∞–∂–∞–ª–∏ "–ò–Ω–∏—Ü–∏–∏—Ä–æ–≤–∞—Ç—å –æ–ø–ª–∞—Ç—É" –ø–µ—Ä–µ–¥ –æ–ø–ª–∞—Ç–æ–π
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —á—Ç–æ `merchant_trans_id` –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π

### ‚ùå –ü–ª–∞—Ç–µ–∂ –ø—Ä–æ—à–µ–ª, –Ω–æ –∞—É–∫—Ü–∏–æ–Ω –Ω–µ –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–ª—Å—è

**–†–µ—à–µ–Ω–∏–µ:**
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å—Ç–∞—Ç—É—Å –ø–ª–∞—Ç–µ–∂–∞ –≤ –∞–¥–º–∏–Ω–∫–µ: https://kvartirabar.uz/admin/
2. –ü–æ—Å–º–æ—Ç—Ä–∏—Ç–µ –ª–æ–≥–∏ Django –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ç–∞–±–ª–∏—Ü—É `auctions_auctionpayment` –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö

## –ü–æ–ª–µ–∑–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã

```bash
# –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å –ª–æ–≥–∏ Django
tail -f /var/log/django/error.log

# –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å –≤—Å–µ –ø–ª–∞—Ç–µ–∂–∏
python manage.py shell
from auctions.models import AuctionPayment
AuctionPayment.objects.all().values('merchant_trans_id', 'status', 'amount')

# –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å –Ω–µ–æ–ø–ª–∞—á–µ–Ω–Ω—ã–µ –∞—É–∫—Ü–∏–æ–Ω—ã
from auctions.models import Auction
Auction.objects.filter(status='pending_payment', is_paid=False)
```

## –ö–æ–Ω—Ç–∞–∫—Ç—ã –ø–æ–¥–¥–µ—Ä–∂–∫–∏

- **Click —Ç–µ—Ö–ø–æ–¥–¥–µ—Ä–∂–∫–∞:** support@click.uz
- **Click Telegram:** @click_support
- **–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è API:** https://docs.click.uz

## –ì–æ—Ç–æ–≤–æ! üéâ

–¢–µ–ø–µ—Ä—å –≤–∞—à–∞ —Å–∏—Å—Ç–µ–º–∞ –∞—É–∫—Ü–∏–æ–Ω–æ–≤ –≥–æ—Ç–æ–≤–∞ –ø—Ä–∏–Ω–∏–º–∞—Ç—å –ø–ª–∞—Ç–µ–∂–∏ —á–µ—Ä–µ–∑ Click!

–ü–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–π –æ–ø–ª–∞—Ç—ã:
- ‚úÖ AuctionPayment.status = 'completed'
- ‚úÖ Auction.is_paid = True
- ‚úÖ Auction.status = 'scheduled' –∏–ª–∏ 'active'
- ‚úÖ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –º–æ–≥—É—Ç –¥–µ–ª–∞—Ç—å —Å—Ç–∞–≤–∫–∏
